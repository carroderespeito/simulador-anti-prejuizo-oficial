<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador Anti-Prejuízo v7.4</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827;
        }
        input::placeholder, select {
            color: #9ca3af;
        }
        .stark-loader {
            border: 4px solid #4b5563;
            border-top: 4px solid #ef4444;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="text-white min-h-screen p-2 sm:p-4">

    <div class="w-full max-w-7xl bg-gray-800 rounded-2xl shadow-2xl p-4 md:p-8 mx-auto">

        <div class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-black text-white tracking-tight">Simulador Anti-Prejuízo</h1>
            <p class="text-gray-400 mt-2">Sua ferramenta definitiva para uma compra segura.</p>
        </div>

        <!-- Seção de Dados Globais -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
             <div>
                <label for="rendaMensal" class="block text-sm font-medium text-gray-300">Sua Renda Mensal (R$)</label>
                <input type="number" id="rendaMensal" placeholder="Ex: 5000" class="global-input mt-1 block w-full bg-gray-900 border-gray-700 rounded-md p-2 text-sm">
            </div>
            <div>
                <label for="kmMes" class="block text-sm font-medium text-gray-300">KM a Rodar por Mês</label>
                <input type="number" id="kmMes" placeholder="Ex: 1000" class="global-input mt-1 block w-full bg-gray-900 border-gray-700 rounded-md p-2 text-sm">
            </div>
            <div>
                <label for="precoCombustivel" class="block text-sm font-medium text-gray-300">Preço do Combustível (R$/l)</label>
                <input type="number" id="precoCombustivel" placeholder="Ex: 6.0" class="global-input mt-1 block w-full bg-gray-900 border-gray-700 rounded-md p-2 text-sm">
            </div>
        </div>

        <!-- Container de Comparação -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

            <!-- Coluna Carro A -->
            <div class="bg-gray-700 p-6 rounded-xl space-y-3">
                <h2 class="text-2xl font-bold mb-4 border-b-2 border-blue-500 pb-2">CARRO A</h2>
                <select id="car-select-A" class="car-select block w-full bg-gray-800 border-gray-600 rounded-md p-3 text-sm" data-car="A">
                    <option value="">-- Selecione um Carro ou Preencha Manualmente --</option>
                </select>
                <input type="number" id="precoCompraA" placeholder="Preço de Compra (R$)" class="data-input block w-full bg-gray-800 border-gray-600 rounded-md p-2 text-sm" data-car="A">
                <input type="number" id="valorRevendaA" placeholder="Valor de Revenda (após 1 ano)" class="data-input block w-full bg-gray-800 border-gray-600 rounded-md p-2 text-sm" data-car="A">
                <input type="number" id="valorIpvaA" placeholder="IPVA Anual (R$)" class="data-input block w-full bg-gray-800 border-gray-600 rounded-md p-2 text-sm" data-car="A">
                <input type="number" id="valorSeguroA" placeholder="Seguro Anual (R$)" class="data-input block w-full bg-gray-800 border-gray-600 rounded-md p-2 text-sm" data-car="A">
                <input type="number" id="consumoCarroA" placeholder="Consumo (km/l)" class="data-input block w-full bg-gray-800 border-gray-600 rounded-md p-2 text-sm" data-car="A">
                <h3 class="text-lg font-semibold pt-2">Financiamento (Opcional)</h3>
                <input type="number" id="valorEntradaA" placeholder="Valor da Entrada (R$)" class="data-input block w-full bg-gray-800 border-gray-600 rounded-md p-2 text-sm" data-car="A">
                 <input type="number" id="taxaJurosA" placeholder="Taxa de Juros Anual (%)" class="data-input block w-full bg-gray-800 border-gray-600 rounded-md p-2 text-sm" data-car="A">
                <input type="number" id="prazoA" placeholder="Prazo (Meses)" class="data-input block w-full bg-gray-800 border-gray-600 rounded-md p-2 text-sm" data-car="A">
            </div>

            <!-- Coluna Carro B -->
            <div class="bg-gray-700 p-6 rounded-xl space-y-3">
                <h2 class="text-2xl font-bold mb-4 border-b-2 border-red-500 pb-2">CARRO B</h2>
                <select id="car-select-B" class="car-select block w-full bg-gray-800 border-gray-600 rounded-md p-3 text-sm" data-car="B">
                    <option value="">-- Selecione um Carro ou Preencha Manualmente --</option>
                </select>
                <input type="number" id="precoCompraB" placeholder="Preço de Compra (R$)" class="data-input block w-full bg-gray-800 border-gray-600 rounded-md p-2 text-sm" data-car="B">
                <input type="number" id="valorRevendaB" placeholder="Valor de Revenda (após 1 ano)" class="data-input block w-full bg-gray-800 border-gray-600 rounded-md p-2 text-sm" data-car="B">
                <input type="number" id="valorIpvaB" placeholder="IPVA Anual (R$)" class="data-input block w-full bg-gray-800 border-gray-600 rounded-md p-2 text-sm" data-car="B">
                <input type="number" id="valorSeguroB" placeholder="Seguro Anual (R$)" class="data-input block w-full bg-gray-800 border-gray-600 rounded-md p-2 text-sm" data-car="B">
                <input type="number" id="consumoCarroB" placeholder="Consumo (km/l)" class="data-input block w-full bg-gray-800 border-gray-600 rounded-md p-2 text-sm" data-car="B">
                <h3 class="text-lg font-semibold pt-2">Financiamento (Opcional)</h3>
                <input type="number" id="valorEntradaB" placeholder="Valor da Entrada (R$)" class="data-input block w-full bg-gray-800 border-gray-600 rounded-md p-2 text-sm" data-car="B">
                <input type="number" id="taxaJurosB" placeholder="Taxa de Juros Anual (%)" class="data-input block w-full bg-gray-800 border-gray-600 rounded-md p-2 text-sm" data-car="B">
                <input type="number" id="prazoB" placeholder="Prazo (Meses)" class="data-input block w-full bg-gray-800 border-gray-600 rounded-md p-2 text-sm" data-car="B">
            </div>
        </div>

        <!-- Seção de Diagnóstico Comparativo - LAYOUT CORRIGIDO -->
        <div class="mt-8 bg-gray-700/50 p-6 rounded-xl">
            <h2 class="text-2xl font-bold mb-6 border-b-2 border-green-500 pb-2">DIAGNÓSTICO DE COMBATE</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Card Carro A -->
                <div class="bg-blue-900/20 p-4 rounded-lg">
                    <h3 class="text-xl font-bold text-blue-300 mb-4 text-center">CARRO A</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between items-center"><span>Depreciação Anual:</span><span id="depreciacaoAnualA" class="font-semibold">R$ 0,00</span></div>
                        <div class="flex justify-between items-center"><span>Gasto Mensal Combustível:</span><span id="custoCombustivelMensalA" class="font-semibold">R$ 0,00</span></div>
                        <div class="flex justify-between items-center"><span>Parcela Mensal (Financ.):</span><span id="parcelaMensalA" class="font-semibold">R$ 0,00</span></div>
                        <div class="flex justify-between items-center border-t border-gray-600 pt-2 mt-2">
                            <span class="font-bold">Custo Mensal Total:</span>
                            <span id="custoRealMensalA" class="font-bold text-lg">R$ 0,00</span>
                        </div>
                         <div class="flex justify-between items-center">
                            <span class="font-bold">% da Renda Mensal:</span>
                            <span id="percentualMensalA" class="font-bold text-lg">0,00%</span>
                        </div>
                    </div>
                </div>
                <!-- Card Carro B -->
                <div class="bg-red-900/20 p-4 rounded-lg">
                    <h3 class="text-xl font-bold text-red-300 mb-4 text-center">CARRO B</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between items-center"><span>Depreciação Anual:</span><span id="depreciacaoAnualB" class="font-semibold">R$ 0,00</span></div>
                        <div class="flex justify-between items-center"><span>Gasto Mensal Combustível:</span><span id="custoCombustivelMensalB" class="font-semibold">R$ 0,00</span></div>
                        <div class="flex justify-between items-center"><span>Parcela Mensal (Financ.):</span><span id="parcelaMensalB" class="font-semibold">R$ 0,00</span></div>
                        <div class="flex justify-between items-center border-t border-gray-600 pt-2 mt-2">
                            <span class="font-bold">Custo Mensal Total:</span>
                            <span id="custoRealMensalB" class="font-bold text-lg">R$ 0,00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-bold">% da Renda Mensal:</span>
                            <span id="percentualMensalB" class="font-bold text-lg">0,00%</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const carDatabase = {
            "SUVs Populares": [
                { name: "VW T-Cross Comfortline 2022", preco: 135000, revenda: 124000, ipva: 5400, seguro: 4500, consumo: 11.5 },
                { name: "Hyundai Creta Platinum 2023", preco: 140000, revenda: 129000, ipva: 5600, seguro: 4800, consumo: 11 },
                { name: "Jeep Renegade Longitude 2022", preco: 125000, revenda: 115000, ipva: 5000, seguro: 4700, consumo: 10.5 },
            ],
            "SUVs Premium (Usados)": [
                 { name: "Audi Q5 Ambition 2018", preco: 180000, revenda: 165000, ipva: 7200, seguro: 7000, consumo: 9 },
                 { name: "BMW X1 sDrive20i 2019", preco: 160000, revenda: 147000, ipva: 6400, seguro: 6000, consumo: 10 },
                 { name: "Volvo XC60 Momentum 2018", preco: 175000, revenda: 160000, ipva: 7000, seguro: 6500, consumo: 9.5 },
            ]
        };

        function populateSelect(selectElement) {
            for (const category in carDatabase) {
                const optgroup = document.createElement('optgroup');
                optgroup.label = category;
                carDatabase[category].forEach(car => {
                    const option = document.createElement('option');
                    option.value = JSON.stringify(car);
                    option.textContent = car.name;
                    optgroup.appendChild(option);
                });
                selectElement.appendChild(optgroup);
            }
        }

        populateSelect(document.getElementById('car-select-A'));
        populateSelect(document.getElementById('car-select-B'));

        function formatCurrency(value) {
            return value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        }

        function formatPercent(value) {
            return value.toFixed(2).replace('.', ',') + '%';
        }
        
        function calculateCosts() {
            const rendaMensal = parseFloat(document.getElementById('rendaMensal').value) || 0;
            const precoCombustivel = parseFloat(document.getElementById('precoCombustivel').value) || 0;
            const kmMes = parseFloat(document.getElementById('kmMes').value) || 0;
            
            ['A', 'B'].forEach(carId => {
                const precoCompra = parseFloat(document.getElementById(`precoCompra${carId}`).value) || 0;
                const valorRevenda = parseFloat(document.getElementById(`valorRevenda${carId}`).value) || 0;
                const valorIpva = parseFloat(document.getElementById(`valorIpva${carId}`).value) || 0;
                const valorSeguro = parseFloat(document.getElementById(`valorSeguro${carId}`).value) || 0;
                const consumoCarro = parseFloat(document.getElementById(`consumoCarro${carId}`).value) || 1;
                
                const valorEntrada = parseFloat(document.getElementById(`valorEntrada${carId}`).value) || 0;
                const taxaJurosAnual = parseFloat(document.getElementById(`taxaJuros${carId}`).value) || 0;
                const prazo = parseInt(document.getElementById(`prazo${carId}`).value) || 0;

                const depreciacaoAnual = precoCompra > 0 ? precoCompra - valorRevenda : 0;
                const custoCombustivelMensal = (kmMes / consumoCarro) * precoCombustivel;
                const custosAnuais = valorIpva + valorSeguro;
                
                let parcelaMensal = 0;
                if (precoCompra > valorEntrada && taxaJurosAnual > 0 && prazo > 0) {
                    const valorFinanciado = precoCompra - valorEntrada;
                    const taxaMensal = (taxaJurosAnual / 100) / 12;
                    parcelaMensal = valorFinanciado * (taxaMensal * Math.pow(1 + taxaMensal, prazo)) / (Math.pow(1 + taxaMensal, prazo) - 1);
                }
                
                const custoMensalTotal = (depreciacaoAnual / 12) + (custosAnuais / 12) + custoCombustivelMensal + parcelaMensal;
                const percentualMensal = rendaMensal > 0 ? (custoMensalTotal / rendaMensal) * 100 : 0;
                
                document.getElementById(`depreciacaoAnual${carId}`).textContent = formatCurrency(depreciacaoAnual);
                document.getElementById(`custoCombustivelMensal${carId}`).textContent = formatCurrency(custoCombustivelMensal);
                document.getElementById(`parcelaMensal${carId}`).textContent = formatCurrency(parcelaMensal);
                document.getElementById(`custoRealMensal${carId}`).textContent = formatCurrency(custoMensalTotal);
                document.getElementById(`percentualMensal${carId}`).textContent = formatPercent(percentualMensal);
            });
            
            compareResults();
        }

        function compareResults() {
            const metrics = ['depreciacaoAnual', 'custoCombustivelMensal', 'parcelaMensal', 'custoRealMensal', 'percentualMensal'];
            metrics.forEach(metric => {
                const valueA_raw = document.getElementById(`${metric}A`).textContent;
                const valueB_raw = document.getElementById(`${metric}B`).textContent;
                
                const valueA = parseFloat(valueA_raw.replace('R$', '').replace(/\./g, '').replace(',', '.'));
                const valueB = parseFloat(valueB_raw.replace('R$', '').replace(/\./g, '').replace(',', '.'));

                const elA = document.getElementById(`${metric}A`).parentElement;
                const elB = document.getElementById(`${metric}B`).parentElement;

                elA.classList.remove('bg-green-500/20', 'bg-red-500/20');
                elB.classList.remove('bg-green-500/20', 'bg-red-500/20');

                if ((valueA > 0 || valueB > 0) && valueA !== valueB) {
                    if (valueA < valueB) {
                        elA.classList.add('bg-green-500/20');
                    } else {
                        elB.classList.add('bg-green-500/20');
                    }
                }
            });
        }

        document.querySelectorAll('.data-input, .global-input').forEach(input => {
            input.addEventListener('input', calculateCosts);
        });

        document.querySelectorAll('.car-select').forEach(select => {
            select.addEventListener('change', (event) => {
                const selectedValue = event.target.value;
                const carId = event.target.dataset.car;
                if (selectedValue) {
                    const car = JSON.parse(selectedValue);
                    document.getElementById(`precoCompra${carId}`).value = car.preco;
                    document.getElementById(`valorRevenda${carId}`).value = car.revenda;
                    document.getElementById(`valorIpva${carId}`).value = car.ipva;
                    document.getElementById(`valorSeguro${carId}`).value = car.seguro;
                    document.getElementById(`consumoCarro${carId}`).value = car.consumo;
                } else {
                    ['precoCompra', 'valorRevenda', 'valorIpva', 'valorSeguro', 'consumoCarro', 'valorEntrada', 'taxaJuros', 'prazo'].forEach(id => document.getElementById(`${id}${carId}`).value = '');
                }
                calculateCosts();
            });
        });

        calculateCosts();
    </script>

</body>
</html>
